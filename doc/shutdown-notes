
what do we want from an orderly shutdown procedure?

 * save all persistant data that can and should be saved
   (this seems like the most important by far)

 * save all dirty configuration file data
   (this is also somewhat important)

 * players should be disconnected properly.

 * players should be sent a message that the server is shutting
   down/recycling.
 
 * free all allocated memory that can be freed
   (this isn't really so important, since of course it all gets freed
   anyway when the process exists. the only consequences of this are
   output from leak checkers, and maybe if we want to do something
   besides just exiting the process.)


so:
  config writes dirty data on unload. that's fine.

  net and chatnet should both disconnect players in response to an
  unload.

  re: persist, in theory, it could do one of those query for all data
  while it's unloading. in fact, that won't work because the modules
  that contain the actual data are unloaded before persist.

  so, there are two options: insert a special call to persist right
  before main is ready to unload all modules, or have persist query for
  the data as the modules are being unloaded (in response to
  UnregPersistentData).

  the second won't really work, since the querying should happen from
  the db thread. that leaves the first.

  re: a nice chat message, that can also be done from main.

